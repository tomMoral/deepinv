:orphan:

.. _examples:

Examples
========

All the examples have a download link at the end. You can load the example's notebook on
`Google Colab <https://colab.research.google.com/>`_ and run them by adding the line

::

    pip install git+https://github.com/deepinv/deepinv.git#egg=deepinv

to the top of the notebook
(e.g., `as in here <https://colab.research.google.com/drive/1ZPKikFM_dov9f-9g2j_S9MIpJSCIk7QF?usp=sharing>`_).




.. raw:: html

    <div class="sphx-glr-thumbnails">


.. raw:: html

    </div>

Basics
-------------------------------




.. raw:: html

    <div class="sphx-glr-thumbnails">


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example we show how to use the deepinv.physics.SinglePhotonLidar forward model.">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_lidar_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_lidar.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Single photon lidar operator for depth ranging.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we show how to stack and concatenate forward operators to create new operators...">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_pansharpening_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_pansharpening.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Stacking and concatenating forward operators.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This code shows how to reconstruct a noisy and incomplete image using the deep image prior.">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_dip_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_dip.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Reconstructing an image using the deep image prior.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to create your own dataset for deep image inverse problems from a base d...">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_dataset_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_dataset.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Creating your own dataset</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="While deepinv offers a large number of forward operators in the physics module, you might want ...">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_physics_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_physics.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Creating a forward operator.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example provides a tour of some of the forward operators implemented in DeepInverse. We re...">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_physics_tour_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_physics_tour.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">A tour of forward sensing operators</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to train a simple reconstruction network for an image inpainting inverse...">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_train_inpainting_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_train_inpainting.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Training a reconstruction network.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we show how to solve a deblurring inverse problem using an explicit prior.">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_custom_prior_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_custom_prior.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Image deblurring with custom deep explicit prior.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Models can be saved and loaded in the same way as in PyTorch. In this example, we show how to d...">

.. only:: html

  .. image:: /auto_examples/basics/images/thumb/sphx_glr_demo_loading_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_basics_demo_loading.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Saving and loading models</div>
    </div>


.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/basics/demo_lidar
   /auto_examples/basics/demo_pansharpening
   /auto_examples/basics/demo_dip
   /auto_examples/basics/demo_dataset
   /auto_examples/basics/demo_physics
   /auto_examples/basics/demo_physics_tour
   /auto_examples/basics/demo_train_inpainting
   /auto_examples/basics/demo_custom_prior
   /auto_examples/basics/demo_loading

Plug-and-Play
-------------




.. raw:: html

    <div class="sphx-glr-thumbnails">


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to use a standart PnP algorithm with DnCNN denoiser for computed tomogra...">

.. only:: html

  .. image:: /auto_examples/plug-and-play/images/thumb/sphx_glr_demo_vanilla_PnP_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plug-and-play_demo_vanilla_PnP.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Vanilla PnP for computed tomography (CT).</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to use the DPIR method to solve a PnP image deblurring problem. The DPIR...">

.. only:: html

  .. image:: /auto_examples/plug-and-play/images/thumb/sphx_glr_demo_PnP_DPIR_deblur_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plug-and-play_demo_PnP_DPIR_deblur.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">DPIR method for PnP image deblurring.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="We use as plug-in denoiser the Gradient-Step Denoiser (GSPnP) which provides an explicit prior.">

.. only:: html

  .. image:: /auto_examples/plug-and-play/images/thumb/sphx_glr_demo_RED_GSPnP_SR_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plug-and-play_demo_RED_GSPnP_SR.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Regularization by Denoising (RED) for Super-Resolution.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to define your own optimization algorithm. For example, here, we impleme...">

.. only:: html

  .. image:: /auto_examples/plug-and-play/images/thumb/sphx_glr_demo_PnP_custom_optim_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plug-and-play_demo_PnP_custom_optim.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">PnP with custom optimization algorithm (Condat-Vu Primal-Dual)</div>
    </div>


.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/plug-and-play/demo_vanilla_PnP
   /auto_examples/plug-and-play/demo_PnP_DPIR_deblur
   /auto_examples/plug-and-play/demo_RED_GSPnP_SR
   /auto_examples/plug-and-play/demo_PnP_custom_optim

Sampling
-------------------------------




.. raw:: html

    <div class="sphx-glr-thumbnails">


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This code shows you how to use sampling algorithms to quantify uncertainty of a reconstruction ...">

.. only:: html

  .. image:: /auto_examples/sampling/images/thumb/sphx_glr_demo_sampling_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_sampling_demo_sampling.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Uncertainty quantification with PnP-ULA.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This code shows you how to use the DDRM diffusion algorithm to reconstruct images and also comp...">

.. only:: html

  .. image:: /auto_examples/sampling/images/thumb/sphx_glr_demo_ddrm_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_sampling_demo_ddrm.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Image reconstruction with a diffusion model</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This code shows how to build your custom sampling kernel. Here we build a preconditioned Unadju...">

.. only:: html

  .. image:: /auto_examples/sampling/images/thumb/sphx_glr_demo_custom_kernel_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_sampling_demo_custom_kernel.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Building your custom sampling algorithm.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this tutorial, we will go over the steps in the Diffusion Posterior Sampling (DPS) algorithm...">

.. only:: html

  .. image:: /auto_examples/sampling/images/thumb/sphx_glr_demo_dps_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_sampling_demo_dps.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Implementing DPS</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this tutorial, we revisit the implementation of the DiffPIR diffusion algorithm for image re...">

.. only:: html

  .. image:: /auto_examples/sampling/images/thumb/sphx_glr_demo_diffpir_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_sampling_demo_diffpir.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Implementing DiffPIR</div>
    </div>


.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/sampling/demo_sampling
   /auto_examples/sampling/demo_ddrm
   /auto_examples/sampling/demo_custom_kernel
   /auto_examples/sampling/demo_dps
   /auto_examples/sampling/demo_diffpir

Self-Supervised Learning
-------------------------------




.. raw:: html

    <div class="sphx-glr-thumbnails">


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a denoiser network in a fully self-supervised way, i.e., us...">

.. only:: html

  .. image:: /auto_examples/self-supervised-learning/images/thumb/sphx_glr_demo_sure_denoising_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_self-supervised-learning_demo_sure_denoising.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Self-supervised denoising with the SURE loss.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a denoiser network in a fully self-supervised way, i.e., us...">

.. only:: html

  .. image:: /auto_examples/self-supervised-learning/images/thumb/sphx_glr_demo_n2n_denoising_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_self-supervised-learning_demo_n2n_denoising.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Self-supervised denoising with the Neighbor2Neighbor loss.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a reconstruction network for an inpainting inverse problem ...">

.. only:: html

  .. image:: /auto_examples/self-supervised-learning/images/thumb/sphx_glr_demo_multioperator_imaging_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_self-supervised-learning_demo_multioperator_imaging.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Self-supervised learning from incomplete measurements of multiple operators.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a reconstruction network for an MRI inverse problem on a fu...">

.. only:: html

  .. image:: /auto_examples/self-supervised-learning/images/thumb/sphx_glr_demo_equivariant_imaging_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_self-supervised-learning_demo_equivariant_imaging.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Self-supervised learning with Equivariant Imaging for MRI.</div>
    </div>


.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/self-supervised-learning/demo_sure_denoising
   /auto_examples/self-supervised-learning/demo_n2n_denoising
   /auto_examples/self-supervised-learning/demo_multioperator_imaging
   /auto_examples/self-supervised-learning/demo_equivariant_imaging

Unfolded
-------------------------------




.. raw:: html

    <div class="sphx-glr-thumbnails">


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to implement the LISTA algorithm for a compressed sensing problem. In a ...">

.. only:: html

  .. image:: /auto_examples/unfolded/images/thumb/sphx_glr_demo_LISTA_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unfolded_demo_LISTA.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Learned Iterative Soft-Thresholding Algorithm (LISTA) for compressed sensing</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to implement a learned unrolled proximal gradient descent algorithm with...">

.. only:: html

  .. image:: /auto_examples/unfolded/images/thumb/sphx_glr_demo_custom_prior_unfolded_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unfolded_demo_custom_prior_unfolded.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Learned iterative custom prior</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This is a simple example to show how to use vanilla unfolded Plug-and-Play. The DnCNN denoiser ...">

.. only:: html

  .. image:: /auto_examples/unfolded/images/thumb/sphx_glr_demo_vanilla_unfolded_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unfolded_demo_vanilla_unfolded.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Vanilla Unfolded algorithm for super-resolution</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This a toy example to show you how to use DEQ to solve a deblurring problem.  Note that this is...">

.. only:: html

  .. image:: /auto_examples/unfolded/images/thumb/sphx_glr_demo_DEQ_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unfolded_demo_DEQ.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Deep Equilibrium (DEQ) algorithms for image deblurring</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Adler, Jonas, and Ozan Ã–ktem.  &quot;Learned primal-dual reconstruction.&quot;  IEEE transactions on medi...">

.. only:: html

  .. image:: /auto_examples/unfolded/images/thumb/sphx_glr_demo_learned_primal_dual_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unfolded_demo_learned_primal_dual.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Learned Primal-Dual algorithm for CT scan.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Image inpainting consists in solving y = Ax where A is a mask operator. This problem can be ref...">

.. only:: html

  .. image:: /auto_examples/unfolded/images/thumb/sphx_glr_demo_unfolded_constrained_LISTA_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unfolded_demo_unfolded_constrained_LISTA.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Unfolded Chambolle-Pock for constrained image inpainting</div>
    </div>


.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/unfolded/demo_LISTA
   /auto_examples/unfolded/demo_custom_prior_unfolded
   /auto_examples/unfolded/demo_vanilla_unfolded
   /auto_examples/unfolded/demo_DEQ
   /auto_examples/unfolded/demo_learned_primal_dual
   /auto_examples/unfolded/demo_unfolded_constrained_LISTA


.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-gallery

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download all examples in Python source code: auto_examples_python.zip </auto_examples/auto_examples_python.zip>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download all examples in Jupyter notebooks: auto_examples_jupyter.zip </auto_examples/auto_examples_jupyter.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
